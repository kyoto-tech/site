---
import Layout from "../layouts/Layout.astro";
import WhyJoin from "../components/WhyJoin.astro";
import WhatWeDo from "../components/WhatWeDo.astro";
import Calendar from "../components/Calendar.astro";
import EventList from "../components/EventList.jsx";
import { FaGithub, FaDiscord, FaMeetup } from "react-icons/fa";
import { useTranslations } from '../i18n/utils';
import LanguagePicker from '../components/LanguagePicker.astro';

const { lang = 'en' } = Astro.props;
const t = useTranslations(lang);

const meetupUrl = lang === 'ja'
	? 'https://www.meetup.com/ja-JP/kyoto-tech-meetup/'
	: 'https://www.meetup.com/kyoto-tech-meetup/';

type ActivityContent =
	| {
			type: "paragraph";
			text: string;
	  }
	| {
			type: "list";
			intro?: string;
			items: string[];
	  };

type Activity = {
	title: string;
	content: ActivityContent[];
};

const benefits = [
	{
		title: t("home.benefit1.title"),
		description: t("home.benefit1.description")
	},
	{
		title: t("home.benefit2.title"),
		description: t("home.benefit2.description")
	},
	{
		title: t("home.benefit3.title"),
		description: t("home.benefit3.description")
	}
];

const activities: Activity[] = [
	{
		title: t("home.activity1.title"),
		content: [
			{
				type: "paragraph",
				text: t("home.activity1.content1")
			},
			{
				type: "paragraph",
				text: t("home.activity1.content2")
			},
			{
				type: "paragraph",
				text: t("home.activity1.content3")
			}
		]
	},
	{
		title: t("home.activity2.title"),
		content: [
			{
				type: "paragraph",
				text: t("home.activity2.content1")
			},
			{
				type: "paragraph",
				text: t("home.activity2.content2")
			},
			{
				type: "paragraph",
				text: t("home.activity2.content3")
			}
		]
	}
];
---

<Layout>
	<header class="relative isolate flex min-h-[70vh] items-center px-6 py-20 text-white sm:py-28 md:px-16">
		<div class="absolute inset-0 -z-10">
			<img
				src="https://images.unsplash.com/photo-1570463723985-41c39db0343d?q=80&w=1335&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D?auto=format&fit=crop&w=2000&q=80"
				alt=""
				loading="lazy"
				fetchpriority="high"
				decoding="async"
				class="h-full w-full object-cover"
			/>
			<div class="absolute inset-0 bg-black/40"></div>
		</div>
		<div class="mx-auto max-w-3xl text-center md:ml-[5%] md:text-left">
			<p class="text-xs font-semibold uppercase tracking-[0.3em] text-white/80">{t("home.header.tagline")}</p>
			<h1 class="mt-4 text-4xl font-semibold leading-tight text-white md:text-5xl">
				{t("home.header.title")}
			</h1>
			<p class="mt-4 text-lg text-white/90">
				{t("home.header.subtitle")}
			</p>
			<a
				class="mt-8 inline-flex items-center justify-center rounded-full bg-(--accent) px-6 py-3 text-base font-semibold text-white! shadow-xl shadow-black/30 transition hover:-translate-y-0.5 hover:bg-(--accent-dark) hover:text-white!"
				href={meetupUrl}
				target="_blank"
				rel="noreferrer"
			>
				{t("home.header.cta")}
			</a>
		</div>
		<LanguagePicker />
	</header>

	<main id="main-content" class="space-y-0">
		<section id="why-join" class="bg-white/95 px-6 py-16 md:px-12">
			<div class="mx-auto max-w-5xl">
				<p class="text-sm font-semibold uppercase tracking-[0.3em] text-slate-500">{t("home.whyJoin.label")}</p>
				<h2 class="mt-3 text-3xl font-semibold text-slate-900">{t("home.whyJoin.title")}</h2>
				<WhyJoin items={benefits} />
			</div>
		</section>

		<section id="whats-happening" class="bg-white/70 px-6 py-16 md:px-12">
			<div class="mx-auto max-w-5xl">
				<p class="text-sm font-semibold uppercase tracking-[0.3em] text-slate-500">{t("home.whatsHappening.label")}</p>
				<h2 class="mt-3 text-3xl font-semibold text-slate-900">{t("home.whatsHappening.title")}</h2>
				<WhatWeDo activities={activities} />
			</div>
		</section>

		<section id="calendar" class="bg-white px-6 py-16 md:px-12">
  			<div class="mx-auto max-w-5xl">
   				<p class="text-sm font-semibold uppercase tracking-[0.3em] text-slate-500">
      			Upcoming Meetups
    			</p>
    			<h2 class="mt-3 text-3xl font-semibold text-slate-900">
      			Kyoto Tech Meetup Calendar
    			</h2>

    			<Calendar />
  			</div>
		</section>

		<section id="who-comes" class="bg-white/95 px-6 py-16 md:px-12">
			<div class="mx-auto flex max-w-5xl flex-col gap-10 lg:flex-row">
				<div class="flex-1">
					<p class="text-sm font-semibold uppercase tracking-[0.3em] text-slate-500">{t("home.whoComes.label")}</p>
					<h2 class="mt-3 text-3xl font-semibold text-slate-900">{t("home.whoComes.title")}</h2>
					<p class="mt-4 text-slate-600">{t("home.whoComes.intro")}</p>
					<ul class="mt-6 list-disc space-y-3 pl-5 text-base leading-relaxed text-slate-600">
						<li>{t("home.whoComes.item1")}</li>
						<li>{t("home.whoComes.item2")}</li>
						<li>{t("home.whoComes.item3")}</li>
						<li>{t("home.whoComes.item4")}</li>
						<li>{t("home.whoComes.item5")}</li>
					</ul>
				</div>
				<div class="flex-1 space-y-4">
					<div class="rounded-2xl bg-white/90 p-6 shadow-lg shadow-stone-900/10 ring-1 ring-white/70">
						<h3 class="text-xl font-semibold text-slate-900">{t("home.languages.title")}</h3>
						<p class="mt-3 text-base leading-relaxed text-slate-600">
							{t("home.languages.description")}
						</p>
					</div>
					<div class="rounded-2xl bg-white/90 p-6 shadow-lg shadow-stone-900/10 ring-1 ring-white/70">
						<h3 class="text-xl font-semibold text-slate-900">{t("home.locations.title")}</h3>
						<p class="mt-3 text-base leading-relaxed text-slate-600">
							{t("home.locations.description1")}
						</p>
						<p class="mt-2 text-base leading-relaxed text-slate-600">
							{t("home.locations.description2")}
						</p>
					</div>
				</div>
			</div>
		</section>
	</main>

		<footer class="bg-stone-950 px-6 py-12 text-slate-100 md:px-12">
			<div class="mx-auto flex max-w-5xl flex-col gap-6 md:flex-row md:items-center md:justify-between">
				<p class="text-sm text-slate-300">Â© {new Date().getFullYear()} {t("home.footer.copyright")}</p>
				<nav aria-label={t("home.footer.socialNavLabel")}>
					<ul class="flex flex-wrap gap-4 text-sm font-medium text-slate-200">
						<li>
							<a
								class="flex items-center gap-2 transition hover:text-white"
								href="https://github.com/kyoto-tech"
								target="_blank"
								rel="noreferrer"
							>
								<FaGithub className="text-lg" /> {t("home.footer.github")}
							</a>
						</li>
						<li>
							<a
								class="flex items-center gap-2 transition hover:text-white"
								href="https://discord.gg/mXFWEHDKeu"
								target="_blank"
								rel="noreferrer"
							>
								<FaDiscord className="text-lg" /> {t("home.footer.discord")}
							</a>
						</li>
						<li>
							<a
								class="flex items-center gap-2 transition hover:text-white"
								href={meetupUrl}
								target="_blank"
								rel="noreferrer"
							>
								<FaMeetup className="text-lg" /> {t("home.footer.meetup")}
							</a>
						</li>
					</ul>
				</nav>
			</div>
		</footer>
	</Layout>
